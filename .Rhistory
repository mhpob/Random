GEcircles <- function (lat, long, radius, color) {
DDlong <- function (x){
d <- as.numeric(substr(x, 2, 3))
m <- as.numeric(substr(x, 5, 6)) / 60
s <- as.numeric(substr(x, 8, 15)) / 3600
-d - m - s
}
DDlat <- function(x){
d <- as.numeric(substr(x, 1, 2))
m <- as.numeric(substr(x, 4, 5)) / 60
s <- as.numeric(substr(x, 7, 15)) / 3600
d + m + s
}
dmslat <- DDlat(lat)
dmslong <- DDlong(long)
# Converts color to KML color code
circ.col <- col2rgb(color)
circ.col <- rgb(circ.col[1], circ.col[2], circ.col[3], 255, maxColorValue = 255)
circ.col <- paste0(substr(circ.col, 8, 9), substr(circ.col, 6, 7),
substr(circ.col, 4, 5), substr(circ.col, 2, 3))
urls <- paste0("http://www.nearby.org.uk/google/circle.kml.php?radius=", radius,
"km&lat=", dmslat, "&long=", dmslong, "&geomColor=", circ.col)
invisible(sapply(urls, shell.exec))
}
source(circle.pts.R)
source('circle.pts.R')
if(('lubridate' %in% installed.packages()) == F) install.packages('lubridate')
library(lubridate)
start <- '1999-01-01'
start <- ymd('1999-01-01')
start
end <- ymd('2001-04-15')
end
day(start)
month(start)
year(start)
station <- 'KNHK'
url <- paste0("http://www.wunderground.com/history/airport/", station, "/",
year(start), "/", month(start), "/", day(start),
"/CustomHistory.html?dayend=", day(end), "&monthend=", month(end),
"&yearend=", year(end), "&format=1")
url
data <- lapply(url, read.csv)
data
head(data)
data <- do.call(rbind.data.frame, data)
View(data)
en
end
View(data)
seq.Date(start,end)
seq(start,end)
seq(start,end, by = year)
seq(start,end, by = 'year')
year(seq(start,end, by = 'year'))
start <- year(seq(ymd(start), end, by = 'year')
start <- year(seq(ymd(start), end, by = 'year'))
start <- ymd('1999-1-1')
start
startyr <- year(seq(ymd(start), end, by = 'year'))
url <- paste0("http://www.wunderground.com/history/airport/", station, "/",
startyr, "/", month(start), "/", day(start),
"/CustomHistory.html?dayend=", day(end), "&monthend=", month(end),
"&yearend=", year(end), "&format=1")
ur
url
data <- lapply(url, read.csv)
data <- do.call(rbind.data.frame, data)
names(data[[1]])
names(data[[2]])
names(data[[3]])
names(data[[4]])
data <- do.call(rbind.data.frame, data)
head(data[[3]])
tail(data[[3]])
tail(data[[1]])
tail(data[[2]])
head(data[[3]])
data1 <- do.call(rbind, data)
?rbind.data.frame
data1 <- do.call(rbind.data.frame, data, check.names = F)
?do.cal
?do.call
?rbind
data1 <- do.call(rbind.data.frame, data, stringsAsFactors = F)
data1 <- do.call(rbind.data.frame, list(data, check.names = F))
data1 <- do.call(rbind.data.frame, list(data, stringsAsFactors = F))
?rbind.data.frame
data1 <- do.call(rbind.data.frame, args = list(data, stringsAsFactors = F))
data1 <- do.call(rbind.data.frame, data, stringsAsFactors = F)
source('~/.active-rstudio-document', echo=TRUE)
data1 <- do.call(rbind.data.frame, data)
?rename
?renames
?renamed
renamed <- function(x){names(x)[1] <- 'Date'}
data1 <- do.call(function(x){names(x)[1] <- 'Date'}, data)
j <- data.frame(a = c(1,2,3), b = (2,3,4))
j <- data.frame(a = c(1,2,3), b = c(2,3,4))
j
j<-renamed(j)
j
j <- data.frame(a = c(1,2,3), b = c(2,3,4))
names(j)[1]
renamed(j)
j
url
data1 <- do.call(function(x){names(x)[1] <- 'Date'; x}, data)
data1 <- do.call(function(x){
names(x)[1] <- 'Date'
x}, data)
names(j)[1] <- 'DATE'
j
data1 <- do.call(names(x)[1] <- 'Date', data)
data1 <- do.call(names(x)[1] <- 'Date', list(x = data))
data1 <- do.call(names(x)[1] <- 'Date', args = list(x = data))
data1 <- do.call(names(x)[1] <- 'Date', args = c(x = data))
data1 <- do.call(names(x)[1] <- 'Date', x = data))
data1 <- do.call(names(x)[1] <- 'Date', x = data)
length(data)
nameS(data[[1]])
names(data[[1]])
names(data[[1]])[1]
for(i in length(data)){
names(data[[i]])[1] <- 'Date'
}
names(data[[1]])
names(data[[2]])
names(data[[3]])
for(i in seq(1:length(data))){
names(data[[i]])[1] <- 'Date'
}
names(data[1])
names(data[[1])
names(data[[1]])
names(data[[2]])
names(data[[3]])
data1 <- do.call(rbind.data.frame, data)
View(data1)
end-start
data1<-unique(data1)
View(data1)
length(data[[1]])
dim(data[[1]])
dim(data[[2]])
dim(data[[3]])
397+301+105
end
start
url
dataa <- do.call(rbind.data.frame, data)
data <- do.call(rbind.data.frame, data)
head(data)
Sys.Date()
ymd(Sys.Date())
?readLines
data <- lapply(url, readLines)
names(data[[1]])
head(data[[1]])
data <- lapply(url, read.csv)
for(i in seq(1:length(data))){
names(data[[i]])[1] <- 'Date'
}
data <- do.call(rbind.data.frame, data, stringsAsFactors = F)
data <- do.call(rbind.data.frame, args = list(data, stringsAsFactors = F))
?do.call
data <- do.call(rbind.data.frame, args = list(x = data, stringsAsFactors = F))
data <- do.call(rbind.data.frame, data)
data[1,23]
data <- lapply(url, read.csv)
for(i in seq(1:length(data))){
names(data[[i]])[1] <- 'Date'
}
data1 <- data.frame(do.call(rbind, data), stringsAsFactors = F)
View(data1)
strsplit(data[1,23], '<br />')
strsplit(data1[1,23], '<br />')
View(data1)
class(data1[23])
class(data1[,23])
class(dataa[,23])
data <- data.frame(do.call(rbind, data), stringsAsFactors = F)
class(data[,23])
data <- lapply(url, read.csv)
for(i in seq(1:length(data))){
names(data[[i]])[1] <- 'Date'
}
data1 <- do.call(rbind, data)
View(data1)
data1 <- do.call(rbind, list(data, stringsAsFactors = F)
)
View(data1)
data1 <- do.call(rbind.data.frame, list(data, stringsAsFactors = F)
)
data1 <- rbindlist(data)
data1 <- do.call(rbind.data.frame, data)
strsplit(data1[1,23],'<')
?strsplit
strsplit(character(data1[1,23]),'<')
strsplit(as.character(data1[1,23]),'<')
strsplit(as.character(data1[1,23]),'<')[1]
strsplit(as.character(data1[1,23]),'<')[[1]][1]
strsplit(as.character(data1[1,23]),'<br />')[[1]][1]
strsplit(as.character(data1[1,23]),'<br />')
data1[,23] <- strsplit(as.character(data1[,23]),'<br />')
data1[,23] <- strsplit(as.character(data1$WindDirDegrees.br...),'<br />')
data1$WindDirDegrees.br... <- strsplit(as.character(data1$WindDirDegrees.br...),'<br />')
View(data1)
data1 <- do.call(rbind.data.frame, data)
data1$WindDirDegrees.br... <- do.call(strsplit(as.character(data1$WindDirDegrees.br...),'<br />'))
data1$WindDirDegrees.br... <- do.call(rbind,strsplit(as.character(data1$WindDirDegrees.br...),'<br />'))
View(data1)
data1 <- do.call(rbind.data.frame, data)
data1[1:10,23]
data1$WindDirDegrees.br... <- do.call(rbind,strsplit(as.character(data1$WindDirDegrees.br...),'<br />'))
View(data1)
data1 <- do.call(rbind.data.frame, data)
data1[23]
data1[23] <- do.call(rbind,strsplit(as.character(data1[23]),'<br />'))
data1[,23] <- do.call(rbind,strsplit(as.character(data1[,23]),'<br />'))
View(data1)
data1 <- do.call(rbind.data.frame, data)
data1[,23] <- do.call(rbind,strsplit(as.character(data1[,23]),'<br />'))
View(data1)
View(data1)
names(data)[23]<- "WindDirDeg"
names(data1)[23]<- "WindDirDeg"
View(data1)
class(data1[23])
class(data1[,23])
data1[1,23]
data1[2,23]
data1[2,2]
data1[23,23]
data1 <- do.call(rbind.data.frame, data)
data1[,23] <- do.call(rbind.data.frame,strsplit(as.character(data1[,23]),'<br />'))
View(data1)
data1[23,23]
data1 <- do.call(rbind.data.frame, data)
data1[,23] <- numeric(do.call(rbind, strsplit(as.character(data1[, 23]), '<br />')))
data1 <- do.call(rbind.data.frame, data)
data1[,23] <- as.numeric(do.call(rbind, strsplit(as.character(data1[, 23]), '<br />')))
View(data1)
data1[1,23]
class(data1)
class(data1[23])
class(data1[,23])
data1[1,23]-data1[2,23]
if(('lubridate' %in% installed.packages()) == F) install.packages('lubridate')
library(lubridate)
wunderimp <- function (station, start, end = Sys.Date()) {
end <- ymd(end)
startyr <- year(seq(ymd(start), end, by = 'year'))
url <- paste0("http://www.wunderground.com/history/airport/", station, "/",
startyr, "/", month(start), "/", day(start),
"/CustomHistory.html?dayend=", day(end), "&monthend=", month(end),
"&yearend=", year(end), "&format=1")
data <- lapply(url, read.csv)
# rbind() will not work unless all colnames are the same. If start and end
# time zones are different, this is reflected in Wundergrounds colnames.
for(i in seq(1:length(data))){
names(data[[i]])[1] <- 'Date'
}
data <- do.call(rbind.data.frame, data)
# Remove HTML breaks from final column
data[,23] <- as.numeric(do.call(rbind, strsplit(as.character(data[, 23]), '<br />')))
names(data)[23]<- "WindDirDeg"
data
}
test <- wunderimp('knhk', 1999-01-01, 2002-04-15)
test <- wunderimp('knhk', '1999-01-01', '2002-04-15')
View(test)
test <- wunderimp('knhk', '1999-01-01', '2002-04-15')
